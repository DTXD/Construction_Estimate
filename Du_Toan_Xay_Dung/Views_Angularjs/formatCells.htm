<!--JQuery sheet-->
<script src="../Scripts/DuToan/Estimate_Work/JQuery/sheet_mainwork.js"></script>

<div>
    <div class="copy">
        <h3>hoho</h3>
        <p>
            FlexSheet also allows user to process non-supported functions met in cell expressions by the <b>unknownFuntion</b> event.  This event will pass the 'UnKnownFunctionEventArgs' to customer.<br />
            This 'UnKnownFunctionEventArgs' provides the function name and the evaluated values list of the parameters. <br />
            Customer can set the 'value' field of 'UnKnownFunctionEventArgs' to customize the miss formula result.
            Otherwise the missed function will return the default error message: <i>'The function "funcName" has not supported in FlexSheet yet.'</i>.
        </p>
    </div>

    <style>
        .cell {
            border-right: 1px solid #c6c6c6;
            border-bottom: 1px solid #c6c6c6;
            outline: none;
            position: absolute;
            height: 28px;
        }

        .row_header {
            border-right: 1px solid #c6c6c6;
            border-top: 1px solid #c6c6c6;
            border-bottom: 1px solid #c6c6c6;
            background: #eaeaea;
            color: #222;
            text-align: center;
            font-weight: 700;
            padding-top: 5px;
            outline: none;
            position: absolute;
            height: 50px;
        }

        .column_header {
            border-right: 1px solid #c6c6c6;
            border-bottom: 1px solid #c6c6c6;
            border-left: 1px solid #c6c6c6;
            background: #eaeaea;
            color: #222;
            text-align: center;
            font-weight: 700;
            padding-top: 5px;
            outline: none;
            position: absolute;
            height: 28px;
        }
        .sheet_cellheader {
            position: relative;
            width: 98.3%;
            height: 50px;
            max-height: inherit;
        }
        .popupsearch {
            width: 700px;
            height: 400px;
            background-color: #F5F4EB;
            -webkit-box-shadow: 1px 1px 3px 4px #E4DBBF; /* Safari 3-4, iOS 4.0.2 - 4.2, Android 2.3+ */
            -moz-box-shadow: 1px 1px 3px 4px #E4DBBF; /* Firefox 3.5 - 3.6 */
            box-shadow: 1px 1px 3px 4px #E4DBBF; /* Opera 10.5, IE 9, Firefox 4+, Chrome 6+, iOS 5 */
        }
    </style>

    <div class="col-sm-12" style="height:800px">
        <div style="width:100%; height:100%">
            <!--row_header-->
            <div class="sheet_cellheader" id="sheet_cellheader">
                <div style="position: absolute; top: 0px; width: 100%; background-color: #eaeaea;">
                    <div style="left:0%;width:3%;top:0px;border-left: 1px solid #c6c6c6;" class="row_header"></div>';
                    <div style="left:3%;width:3%;top:0px;" class="row_header">STT</div>
                    <div style="left:6%;width:6%;top:0px;" class="row_header">Mã Hiệu</div>
                    <div style="left:12%;width:21%;top:0px;" class="row_header">Tên Công Việc</div>
                    <div style="left:33%;width:6%;top:0px;" class="row_header">Đơn Vị</div>
                    <div style="left:39%;width:5%;top:0px;" class="row_header">Số Lượng</div>
                    <div style="left:44%;width:5%;top:0px;" class="row_header">Dài</div>
                    <div style="left:49%;width:5%;top:0px;" class="row_header">Rộng</div>
                    <div style="left:54%;width:5%;top:0px;" class="row_header">Cao</div>
                    <div style="left:59%;width:5%;top:0px;" class="row_header">Khối Lượng</div>
                    <div style="left:64%;width:6%;top:0px;" class="row_header">ĐGVL</div>
                    <div style="left:70%;width:6%;top:0px;" class="row_header">ĐGNC</div>
                    <div style="left:76%;width:6%;top:0px;" class="row_header">ĐGMTC</div>
                    <div style="left:82%;width:6%;top:0px;" class="row_header">TTVL</div>
                    <div style="left:88%;width:6%;top:0px;" class="row_header">TTNC</div>
                    <div style="left:94%;width:6%;top:0px;" class="row_header">TTMTC</div>
                </div>
            </div>
            <!--Center-->
            <div style="position: relative; width: 100%; height: 100%; max-height: inherit;">
                <div style="position: absolute; top: 0px; width: 100%; height: 70%; background-color: white; overflow-y:auto" id="sheet_cellcenter">
                    <script>
                        $(document).ready(function () {
                            var cell_center = $("#sheet_cellcenter");

                            /*
                            var column_clear = '<div style="left:0%;width:3%;top:0px;border-left: 1px solid #c6c6c6;" class="row_header"></div>';
                            var column_stt = '<div style="left:3%;width:3%;top:0px;" class="row_header">STT</div>';
                            var column_mahieu = '<div style="left:6%;width:6%;top:0px;" class="row_header">Mã Hiệu</div>';
                            var column_tencv = '<div style="left:12%;width:21%;top:0px;" class="row_header">Tên Công Việc</div>';
                            var column_donvi = '<div style="left:33%;width:6%;top:0px;" class="row_header">Đơn Vị</div>';
                            var column_soluong = '<div style="left:39%;width:5%;top:0px;" class="row_header">Số Lượng</div>';
                            var column_dai = '<div style="left:44%;width:5%;top:0px;" class="row_header">Dài</div>';
                            var column_rong = '<div style="left:49%;width:5%;top:0px;" class="row_header">Rộng</div>';
                            var column_cao = '<div style="left:54%;width:5%;top:0px;" class="row_header">Cao</div>';
                            var column_khoiluong = '<div style="left:59%;width:5%;top:0px;" class="row_header">Khối Lượng</div>';
                            var column_dgvl = '<div style="left:64%;width:6%;top:0px;" class="row_header">ĐGVL</div>';
                            var column_dgnc = '<div style="left:70%;width:6%;top:0px;" class="row_header">ĐGNC</div>';
                            var column_dgmtc = '<div style="left:76%;width:6%;top:0px;" class="row_header">ĐGMTC</div>';
                            var column_ttvl = '<div style="left:82%;width:6%;top:0px;" class="row_header">TTVL</div>';
                            var column_ttnc = '<div style="left:88%;width:6%;top:0px;" class="row_header">TTNC</div>';
                            var column_ttmtc = '<div style="left:94%;width:6%;top:0px;" class="row_header">TTMTC</div>';
                            cell_center.append(column_clear);
                            cell_center.append(column_stt);
                            cell_center.append(column_mahieu);
                            cell_center.append(column_tencv);
                            cell_center.append(column_donvi);
                            cell_center.append(column_soluong);
                            cell_center.append(column_dai);
                            cell_center.append(column_rong);
                            cell_center.append(column_cao);
                            cell_center.append(column_khoiluong);
                            cell_center.append(column_dgvl);
                            cell_center.append(column_dgnc);
                            cell_center.append(column_dgmtc);
                            cell_center.append(column_ttvl);
                            cell_center.append(column_ttnc);
                            cell_center.append(column_ttmtc);
                            */

                            
                            for (var i = 0; i < 25; i++) {                                  //column

                                var d_left = 0;
                                var css_top = "top:" + parseInt(28 * i) + "px;";
                                var temp = '<div style="';
                                var input = '<input type="text" style="width:100%; border:0px; height:27px;padding-left:4px"';

                                for (var j = 0; j < 16; j++)                                //row
                                {
                                    var d_width = 6;
                                    if (j >= 0 && j <= 1) {
                                        d_width = 3;
                                    }
                                    if (j == 3) {
                                        d_width = 21;
                                    }
                                    if (j >= 5 && j <= 9) {
                                        d_width = 5;
                                    }
                                    var css_width = "width:" + d_width + "%;";
                                    var css_left = "left:" + d_left + "%;";
                                    d_left = d_left + d_width;
                                    var div = temp;
                                    div = div + css_left + css_top + css_width;

                                    if (j == 0) {
                                        div = div + '"' + 'class="column_header">' + i + '</div>';
                                    }
                                    else if (j == 3) {
                                        div = div + '"' + 'class="cell">' + input + 'name="txt_namework"' + '/>' + '</div>';
                                    }
                                    else {
                                        div = div + '"' + 'class="cell">' + input + '</div>';

                                    }
                                    cell_center.append(div);

                                }
                            }
                        });
                    </script>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="popupsearch" style="display:none"> 
    <div class="form-group" style="margin-top:10px">
        <div class="col-sm-12">
            <input class="form-control" id="txt_search" name="txt_search" placeholder="Nhập công việc cần tìm kiếm..." />
        </div>
        <div class="col-sm-12" style="margin-top:10px;">
            <div class="box-body table-responsive no-padding" style="height:300px; overflow-y:auto">
                <table class="table table-hover">
                    <tbody id="table_search_normwork">
                        <tr>
                            <th></th>
                            <th>Mã Hiệu</th>
                            <th>Công Tác</th>
                            <th>Đơn Vị</th>
                        </tr>
                    </tbody>
                </table>
            </div><!-- /.box-body -->
        </div>
        <div class="col-sm-12" style="margin-top:5px">
            <div class="col-sm-3"></div>
            <div class="col-sm-3">
                <button class="btn btn-block btn-primary" id="btn_search_normwork">Chọn</button>
            </div>
            <div class="col-sm-3"></div>
            <div class="col-sm-3"></div>
        </div>
    </div>
</div>